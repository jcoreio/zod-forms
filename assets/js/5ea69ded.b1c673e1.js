"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3216],{9869:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>d,toc:()=>c});var s=i(6070),t=i(5710);const a={},o="Custom Validation",d={id:"howto/custom-validation",title:"Custom Validation",description:"In your form schema, use .refine and .superRefine",source:"@site/docs/howto/custom-validation.md",sourceDirName:"howto",slug:"/howto/custom-validation",permalink:"/zod-forms/docs/howto/custom-validation",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/howto/custom-validation.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"How To",permalink:"/zod-forms/docs/category/how-to"},next:{title:"Reusable Field Components",permalink:"/zod-forms/docs/howto/reusable-field-components"}},r={},c=[{value:"Validating a Single Field",id:"validating-a-single-field",level:2},{value:"Comparing Fields",id:"comparing-fields",level:2},{value:"Conditional Validation",id:"conditional-validation",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"custom-validation",children:"Custom Validation"}),"\n",(0,s.jsxs)(n.p,{children:["In your form schema, use ",(0,s.jsx)(n.a,{href:"https://zod.dev/?id=refine",children:(0,s.jsx)(n.code,{children:".refine"})})," and ",(0,s.jsx)(n.a,{href:"https://zod.dev/?id=superrefine",children:(0,s.jsx)(n.code,{children:".superRefine"})}),"\nfor field validation."]}),"\n",(0,s.jsx)(n.h2,{id:"validating-a-single-field",children:"Validating a Single Field"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://zod.dev/?id=refine",children:(0,s.jsx)(n.code,{children:".refine"})})," is convenient for single-field validation:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const schema = z.object({\n  serverUrl: z\n    .string()\n    .url()\n    .optional()\n    .refine((url) => {\n      try {\n        return url == null || new URL(url).protocol === 'mqtts'\n      } catch {\n        return false\n      }\n    }, 'must be a valid mqtts url'),\n})\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"error message example",src:i(1285).A+"",width:"442",height:"200"})}),"\n",(0,s.jsx)(n.h2,{id:"comparing-fields",children:"Comparing Fields"}),"\n",(0,s.jsxs)(n.p,{children:["To validate one field against another, use ",(0,s.jsx)(n.a,{href:"https://zod.dev/?id=superrefine",children:(0,s.jsx)(n.code,{children:".superRefine"})}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const schema = z\n  .object({\n    min: z.number().finite(),\n    max: z.number().finite(),\n  })\n  .superRefine(({ min, max }, ctx) => {\n    if (min > max) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        path: [...ctx.path, 'min'],\n        message: 'must be <= max',\n      })\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        path: [...ctx.path, 'max'],\n        message: 'must be >= min',\n      })\n    }\n  })\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"error message example",src:i(485).A+"",width:"828",height:"208"})}),"\n",(0,s.jsx)(n.h2,{id:"conditional-validation",children:"Conditional Validation"}),"\n",(0,s.jsxs)(n.p,{children:["You can use ",(0,s.jsx)(n.a,{href:"https://zod.dev/?id=superrefine",children:(0,s.jsx)(n.code,{children:".superRefine"})})," to only validate one field when another is defined:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const schema = z\n  .object({\n    dataType: z.enum(['string', 'number']),\n    displayPrecision: z.number().finite().optional(),\n  })\n  .superRefine(({ dataType, displayPrecision }, ctx) => {\n    if (dataType === 'number' && displayPrecision == null) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        path: [...ctx.path, 'displayPrecision'],\n        message: 'Required when dataType is number',\n      })\n    }\n  })\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"error message example",src:i(3498).A+"",width:"918",height:"204"}),"\n",(0,s.jsx)(n.img,{alt:"inactive validation example",src:i(3638).A+"",width:"852",height:"180"})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},3638:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/conditional-validation-inactive-716ebfd57e6565de48feeb619e4ba2db.png"},3498:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/conditional-validation-d74bb1ffe68099cf0b1841011112449f.png"},485:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/min-max-validation-808583d4572bbaeaf151dc4237706c1a.png"},1285:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/single-field-validation-912c27b57ae83350820c5f9278455a52.png"},5710:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var s=i(758);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);